{{/* fingerprint */}}
{{- $fingerprint := .Scratch.Get "fingerprint" | default "" -}}

{{/* critical style */}}
{{- $style := dict "Source" "scss/critical.scss" "Fingerprint" $fingerprint -}}
{{- $options := dict "enableSourceMap" true "includePaths" (slice "node_modules") -}}
{{- $style = dict "Context" . "ToCSS" $options "Inline" true | merge $style -}}
{{- partial "plugin/style.html" $style -}}

{{/* main style */}}
{{- if site.Params.bundled -}}
  <link
    rel="stylesheet"
    as="style"
    onload="this.onload=null;this.rel='stylesheet'"
    href="/bundled/css/style.min.css"
  />
  <noscript><link rel="stylesheet" href="/bundled/css/style.min.css" /></noscript>
{{- else -}}
  {{- $style := dict "Source" "scss/style.scss" "Fingerprint" $fingerprint -}}
  {{- $style := dict "Source" "scss/style.scss" "Fingerprint" $fingerprint -}}
  {{- $options := dict "targetPath" "css/style.css" "enableSourceMap" true "includePaths" (slice "node_modules") -}}
  {{- $style = dict "Context" . "ToCSS" $options "Minify" hugo.IsProduction "Defer" true | merge $style -}}
  {{- partial "plugin/style.html" $style -}}
{{- end -}}

{{/* main js */}}
<script type="module" src="bundled/js/main.js" defer></script>

{{/* fonts */}}
<link
  rel="preload"
  href="/lib/fonts/GeistVF.woff2"
  as="font"
  type="font/woff2"
  crossorigin
/>
<link rel="preload" href="/lib/fonts/fw.svg" as="font" type="font/svg" crossorigin />
